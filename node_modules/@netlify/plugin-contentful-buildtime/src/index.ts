export const onPreBuild = () => {
  const icomingHookBody = process.env.INCOMING_HOOK_BODY;

  if (!icomingHookBody) {
    console.log("No incoming hook body found");
    return;
  }

  const keyNameOfPreviewBool = process.env.CONTENTFUL_KEY_NAME_OF_PREVIEW_BOOL;

  if (!keyNameOfPreviewBool) {
    throw new Error(
      "CONTENTFUL_KEY_NAME_OF_PREVIEW_BOOL is not defined in environment variables"
    );
  }

  const isPreview = icomingHookBody.includes("isPreview=true");

  console.log(`Mutating env: ${keyNameOfPreviewBool}="${isPreview}"}`);
  process.env[keyNameOfPreviewBool] = isPreview.toString();
};
